<html>
	<head>
		<meta name="apple-mobile-web-app-capable" content="yes" />
		<style>
		</style>
	</head>
	
	<body>
		<select id="camera"></select>

		<video id="video" width="640" height="480" autoplay loop muted playsinline></video>
		<canvas id="canvas" width="640" height="480"></canvas>

		<script src="https://code.jquery.com/jquery-3.5.0.min.js" integrity="sha256-xNzN2a4ltkB44Mc/Jz3pT4iU1cmeR0FkXs4pru/JxaQ=" crossorigin="anonymous"></script>
		<script>
			function populateCamera(devices) {
				$(devices).each(function(i, device){
					if(device.kind == 'videoinput'){
						$('#camera').append('<option value="'+device.deviceId+'">'+device.label+'</option>')
					}
				})
			}

			// Put event listeners into place
			window.addEventListener("DOMContentLoaded", function() {
				// Grab elements, create settings, etc.
				var canvas = document.getElementById('canvas');
				var context = canvas.getContext('2d');
				var video = document.getElementById('video');
				
				navigator.mediaDevices.enumerateDevices().then(populateCamera)

				$('#camera').change(function(){
					console.log('Change')
				})

				var mediaConfig = {
					video: true
				};
				
				var errBack = function(e) {
					console.log('An error has occurred!', e)
				};
				
				// Put video listeners into place
				if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
					navigator.mediaDevices.getUserMedia(mediaConfig).then(function(stream) {
						//video.src = window.URL.createObjectURL(stream);
						video.srcObject = stream;
						video.play();
					});
				}
				/* Legacy code below! */
				else if (navigator.getUserMedia) { // Standard
					navigator.getUserMedia(mediaConfig, function(stream) {
						video.src = stream;
						video.play();
					}, errBack);
				} else if (navigator.webkitGetUserMedia) { // WebKit-prefixed
					navigator.webkitGetUserMedia(mediaConfig, function(stream) {
						video.src = window.webkitURL.createObjectURL(stream);
						video.play();
					}, errBack);
				} else if (navigator.mozGetUserMedia) { // Mozilla-prefixed
						navigator.mozGetUserMedia(mediaConfig, function(stream) {
						video.src = window.URL.createObjectURL(stream);
						video.play();
					}, errBack);
				}
			}, false);
		</script>
	</body>
</html>
